
<!doctype html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://getbootstrap.com/docs/5.3/assets/css/docs.css" rel="stylesheet">
    <title>BOOK YOU CALL NOW</title>

    <style>
        body {background-color: rgb(249, 183, 3);}
        h1   {color: rgb(255, 255, 255);}
        p    {color: red;}
        input{width: 25%;}
        </style>
</head>
<body style="text-align:center" style="background-color: rgb(64, 76, 34);">
    <form style="background-color:rgb(9, 11, 11);"  onsubmit="saveToLocalStorage(event)" method="post"><br>
        <h1 style="color:rgb(255, 255, 255);">Booking App</h1>
        <p style="color: rgb(242, 255, 4);">Book your CALL Now....</p>
        <hr><br>

        <div class="mb-3">
            <label for="name" class="form-label" style="color: azure;">ENTER YOUR NAME:</label>
            <input type="text" class="form-control" id="name" name="name" size="50">
        </div>
        <div class="mb-3">
            <label for="phone" class="form-label" style="color: azure;">ENTER YOUR Number:</label>
            <input type="number" class="form-control" id="phone" name="phone" size="50">
        </div>
        <div class="mb-3">
            <label for="email" class="form-label" style="color: azure;">ENTER YOUR EMAIL :</label>
            <input type="email" class="form-control" id="email" name="email" size="50" required>
        </div><br>
        <div class="mb-3">
            <label for="reason" style="color: azure;"> CHOOSE A REASON:</label>
            <select id="reason" name="reason">
                <option value="reason 1">B2C</option>
                <option value="reason 2">B2B</option>
                <option value="reason 3">OTHER</option>
              </select>
        </div><br>
        <button type="submit" class="btn btn-warning btn-lg">TALK TO EXPERT'S</button>
        <br><br><br>
    </form><br><br><br><br>

    <h1 style="background-color: rgb(57, 12, 219);">Restorent Orders :</h1>
    <div style="background-color: rgb(15, 234, 227);">
    <ul id="listofperson"></ul><hr>
    </div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/axios/1.3.5/axios.min.js" ></script>   

<script>function saveToLocalStorage(event){
    event.preventDefault();
    const name=event.target.name.value;
    const phone=event.target.phone.value;
    const email=event.target.email.value;
    const reason=event.target.reason.value;
    let myObj={
        name:name,
       phone:phone,
       email:email,
       reason:reason
    }
   var myObjnew=JSON.stringify(myObj);
   async function getActivity(){
    try{
        let respone=await axios.post('http://localhost:3000/user/add-user',myObj)
        showUserOnScreen(respone.data)
        console.log(respone.data)
    }catch(err){
        console.log(err)
    }

}
getActivity()

}

    function showUserOnScreen(user){
            const parentEle=document.getElementById('listofperson')
            const childEle =document.createElement('li')
            childEle.textContent='  NAME : '+user.name+'___phoneNumber: '+user.phone+'___Email : '+user.email+'___reason :'+user.reason
            const deleteBtn =document.createElement('input')
            deleteBtn.type='button'
            deleteBtn.style.margin='25px'
            deleteBtn.style.backgroundColor='red'
            deleteBtn.style.color='white'
            deleteBtn.value='Cancel Order'
            deleteBtn.onclick=() => {
                async function getActivity2(){
                    try{
                        let respone=await axios.delete(`http://localhost:3000/user/delete-user/${user.id}`)
                        parentEle.removeChild(childEle)
                        console.log(`${respone}------delete req`)
                    }catch(err){
                        console.log(err)
                    }
            
                }getActivity2()
            }
            childEle.appendChild(deleteBtn)
            parentEle.appendChild(childEle) 

        }
    // two ways to acheive goal
//  WITH DOM CONENT LOADED
    window.addEventListener("DOMContentLoaded",(event)=>{

        async function getActivity4(){
            try{
                let respone = await axios.get("http://localhost:3000/user/get-user")
                .then((respone)=>{ 
                    for(var i=0;i<respone.data.allUsers.length;i++){
                     showUserOnScreen(respone.data.allUsers[i])
                }
                console.log(`${respone.data.allUsers}-----line112 get req..`)
                })
                
                
            }catch(err){
                console.log(err)
            }
    
        }
        getActivity4()

    })</script>
</body>